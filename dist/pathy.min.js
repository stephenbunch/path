!function(){"use strict";var e=function(){function e(t){return this instanceof e?(this.value=t,void(this.path=t.split("."))):new e(t)}function t(e,t,r){function n(e){return arguments.length&&f(e),a()}function i(e){return function(){var t;if(this.hasOwnProperty("$super")){var r=this.$super;this.$super=n,t=e.apply(this,arguments),this.$super=r}else this.$super=n,t=e.apply(this,arguments),delete this.$super;return t}}var s,u=Object.getOwnPropertyDescriptor(e,t);(!u||u.hasOwnProperty("value"))&&(s=e[t]);var a=u&&u.get&&u.get.bind(e)||function(){return s},f=u&&u.set&&u.set.bind(e)||function(e){s=e},l=r.get&&i(r.get),p=r.set&&i(r.set),c=o({},r);return c.get=c.get&&function(){return l?l.call(this):a()}||void 0,c.set=c.set&&function(e){p?p.call(this,e):f(e)}||void 0,Object.defineProperty(e,t,c),{$super:n,restore:function(){if(u)u.hasOwnProperty("value")&&(u.value=s),Object.defineProperty(e,t,u);else{var r=e[t];delete e[t],e[t]=r}}}}function r(e,t,r){e.hasOwnProperty("$$pathListeners")||Object.defineProperty(e,"$$pathListeners",{value:{},configurable:!1,enumerable:!1});var i=e.$$pathListeners;if(!i[t]){i[t]=[];var o=Object.getOwnPropertyDescriptor(e,t);i[t].descriptor=o;var s,u=o&&o.get,a=o&&o.set;u||(s=e[t]),Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function(){return u?u():s},set:function(r){var n=e[t];a?a(r):s=r,r=e[t],n!==r&&i[t].forEach(function(e){e({oldval:n,newval:r})})}})}return i[t].push(r),n.bind(void 0,e,t,r)}function n(e,t,r){var n=e.$$pathListeners;if(n&&n[t]){var i=n[t].indexOf(r);if(i>-1&&(n[t].splice(i,1),0===n[t].length)){if(n[t].descriptor)Object.defineProperty(e,t,n[t].descriptor);else{var o=e[t];delete e[t],e[t]=o}delete n[t]}}}function i(e,t){for(var r=0,n=e.length;n>r&&t.call(e,e[r],r)!==!1;r++);}function o(e,t){t=t||{};for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e}var s=e;return e.prototype.override=function(e,n){function s(e){i(f,function(i,o){if(!(e>o)){var f=a[o].value,h={};if(a.push(h),o===l){var v=t(f,i,n);h.restore=v.restore,c&&n.set&&(f[i]=v.$super())}else if(h.value=f[i],h.restore=r(f,i,function(e){h.value=e.newval,"object"==typeof e.oldval&&u(o+1),"object"==typeof e.newval&&s(o+1)}),"object"!=typeof h.value||null===h.value){if(!p)return!1;h.value=f[i]={}}}})}function u(e){a.splice(e+1).reverse().forEach(function(e){e.restore()})}var a=[{value:e}],f=this.path.slice(),l=f.length-1;n=o({enumerable:!0,configurable:!0,persist:!1,initialize:!0},n);var p=n.persist,c=n.initialize;return delete n.persist,delete n.initialize,s(0),function(){u(0)}},e.prototype.watch=function(e,t){var r,n=!1,i=this.override(e,{set:function(e){if(n){if(e=this.$super(e),e!==r){var i=r;r=e,t.call(void 0,{oldval:i,newval:e})}}else r=e}});return n=!0,i},e.prototype.get=function(e){if("object"==typeof e&&null!==e){for(var t=e,r=0,n=this.path.length-1;n>r&&(t=t[this.path[r]],"object"==typeof t&&null!==t);r++);return t&&t[this.path[n]]}},e.prototype.set=function(e,t){for(var r=0,n=this.path.length-1;n>r;r++)"object"!=typeof e[this.path[r]]&&(e[this.path[r]]={}),e=e[this.path[r]];e[this.path[n]]=t},s}();"undefined"!=typeof module&&module.exports?module.exports=e:("function"==typeof define&&define.amd&&define(function(){return e}),window.pathy=e)}();